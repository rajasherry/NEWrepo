//***********************************************************
import groovy.json.JsonBuilder
import groovy.json.JsonSlurper
import groovy.json.JsonOutput

import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;

      File file = new File("D:/Loksai/Json/20180910_175639.json")
      String outputFile = "D:/Loksai/Json/config.json"
      def fileWriter = new FileWriter(outputFile)

      
      println "Below is the content of the file ${file.absolutePath}"
      def lineNo = 1
      def line
      def jsonSlurper = new JsonSlurper()
    //  def builder = new JsonBuilder()

      file.withReader { reader ->
         while ((line = reader.readLine())!=null) {
            println "${lineNo}. ${line}"
            String rec = "${line}"
   //         println rec
   //         println "kjh:  ${line}"

            def jsonObject = jsonSlurper.parseText(rec)
            println "Individual Attributes"
            println "---------------------"
            
            println "JSONObject Source Time : " + jsonObject.source_time
            println "JSONObject ElapseTime  : " + jsonObject.fields.db_elapsed_time
            if (jsonObject.fields.db_elapsed_time == null)
            {
            println "jsonObject.fields.db_elapsed_time is Null at ${lineNo}"
            }
            else
            {
            println jsonObject.fields.db_elapsed_time
    //        println "JSONObject First Name In : " + jsonObject.fields.input_parameters.acct.billing_group[0][0].first_name
            }
            
            if (jsonObject.fields.input_parameters.acct == null)
            {
            println "jsonObject.fields.input_parameters.acct.billing_group[0][0].first_name is Null at Line# ${lineNo}"
            println "jsonObject.fields.input_parameters.acct.billing_group[0][0].last_name is Null at Line# ${lineNo}"
            println "jsonObject.fields.input_parameters.acct.billing_group[0][0].address1 is Null at Line# ${lineNo}"
            println "jsonObject.fields.input_parameters.acct.billing_group[0][0].phone is Null at Line# ${lineNo}"
            println "jsonObject.fields.input_parameters.acct[0].first_name is Null at Line# ${lineNo}"
            println "jsonObject.fields.input_parameters.acct[0].last_name is Null at Line# ${lineNo}"
            println "jsonObject.fields.input_parameters.acct[0].address1 is Null at Line# ${lineNo}"
            println "jsonObject.fields.input_parameters.acct[0].phone is Null at Line# ${lineNo}"
            println "jsonObject.fields.input_parameters.acct[0].email is Null at Line# ${lineNo}"
            }
            else
            {
     //       println jsonObject.fields.input_parameters.acct.billing_group[0][0].first_name
            println "JSONObject First Name In : " + jsonObject.fields.input_parameters.acct.billing_group[0][0].first_name
            println "JSONObject Last Name In  : " + jsonObject.fields.input_parameters.acct.billing_group[0][0].last_name
            println "JSONObject Address In    : " + jsonObject.fields.input_parameters.acct.billing_group[0][0].address1
            println "JSONObject Phone # In    : " + jsonObject.fields.input_parameters.acct.billing_group[0][0].phone
            println "JSONObject FirstName out : " + jsonObject.fields.input_parameters.acct[0].first_name
            println "JSONObject LastName out  : " + jsonObject.fields.input_parameters.acct[0].last_name
            println "JSONObject Address out   : " + jsonObject.fields.input_parameters.acct[0].address1
            println "JSONObject Phone # out   : " + jsonObject.fields.input_parameters.acct[0].phone
            println "JSONObject Email ID out  : " + jsonObject.fields.input_parameters.acct[0].email
            }            
            println "---------------------"
            
    //        def builder = new JsonBuilder(rec)
    //        builder.fields.db_elapsed_time = '99.99'
            //println(builder.toPrettyString())
  //          println builder.toString()
            def content = "${line}"
            def slurped = new JsonSlurper().parseText(content)
            def builder = new JsonBuilder(slurped)
            builder.content.fields.db_elapsed_time = '9999.9999'
            
            if (builder.content.fields.input_parameters.acct == null)
            {
            println "builder.content.fields.input_parameters.acct.billing_group[0][0].first_name is Null at Line# ${lineNo}"
            println "builder.content.fields.input_parameters.acct.billing_group[0][0].last_name is Null at Line# ${lineNo}"
            println "builder.content.fields.input_parameters.acct.billing_group[0][0].address1 is Null at Line# ${lineNo}"
            println "builder.content.fields.input_parameters.acct.billing_group[0][0].phone is Null at Line# ${lineNo}"
            println "builder.content.fields.input_parameters.acct[0].first_name is Null at Line# ${lineNo}"
            println "builder.content.fields.input_parameters.acct[0].last_name is Null at Line# ${lineNo}"
            println "builder.content.fields.input_parameters.acct[0].address1 is Null at Line# ${lineNo}"
            println "builder.content.fields.input_parameters.acct[0].phone is Null at Line# ${lineNo}"
            println "builder.content.fields.input_parameters.acct[0].email is Null at Line# ${lineNo}"
            }
            else
            {
            builder.content.fields.input_parameters.acct.billing_group[0][0].first_name = 'XXXXXXX'
            builder.content.fields.input_parameters.acct.billing_group[0][0].last_name = 'XXXXXXXX'  
            builder.content.fields.input_parameters.acct.billing_group[0][0].address1 = 'XXXXXXXXX'  
            builder.content.fields.input_parameters.acct.billing_group[0][0].phone = 'XXX-XXX-XXXX'  
            builder.content.fields.input_parameters.acct[0].first_name = 'XXXXXXXXX'  
            builder.content.fields.input_parameters.acct[0].last_name = 'XXXXXXXXX'  
            builder.content.fields.input_parameters.acct[0].address1 = 'XXXXXXXX'  
            builder.content.fields.input_parameters.acct[0].phone = 'XXX-XXX-XXXX'  
            builder.content.fields.input_parameters.acct[0].email = 'XXXXXXXXXXXXXXXX'              
            }                        
   //         println(builder.toPrettyString())
            println(builder.toString())
            
            String maskedRec = builder.toString()
            
//            String rec = "${line}"

   //         println "kjh:  ${line}"
            println "MaskedRec: ${maskedRec}"

            builder.writeTo(fileWriter)
            
            fileWriter.flush() /* to push the data from  buffer to file */
            fileWriter.flush()
            println "Config details are written into the file '${outputFile}'"
            println ""
            def fileContents = new File(outputFile).text
            println "File contents : " + fileContents
            println ""
            println "File Contents PrettyPrint"
            println "========================="
            println JsonOutput.prettyPrint(fileContents)
           
//            println "JSONObject ElapseTime  : " + jsonObject.fields.db_elapsed_time

            lineNo++
         }
      }
